(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{66:function(e,t,c){},67:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c(1),s=c.n(a),r=c(28),i=c.n(r),l=c(16),o=c(2),j=c(3),u=function(e,t,c){var r=s.a.createContext();return{Context:r,Provider:function(s){var i=s.children,l=Object(a.useReducer)(e,c),u=Object(j.a)(l,2),d=u[0],b=u[1],h={};for(var O in t)h[O]=t[O](b);return Object(n.jsx)(r.Provider,{value:Object(o.a)({state:d},h),children:i})}}},d=c(5),b=u((function(e,t){switch(t.type){case"chat_users":return Object(o.a)(Object(o.a)({},e),{},{users:t.payload});case"set_user":return Object(o.a)(Object(o.a)({},e),{},{user:t.payload});case"community_chat":return Object(o.a)(Object(o.a)({},e),{},{chats:[].concat(Object(l.a)(e.chats),[t.payload])});case"set_active_chat":return Object(o.a)(Object(o.a)({},e),{},{activeChat:t.payload});case"send_message":return Object(o.a)(Object(o.a)({},e),{},{chats:t.payload});case"add_private_chat":return Object(o.a)(Object(o.a)({},e),{},{chats:[].concat(Object(l.a)(e.chats),[t.payload])});default:return e}}),{setUser:function(e){return function(t,c){t.emit("VERIFY_USER",c,(function(t){var c=t.isUser,n=t.user;if(c)return null;e({type:"set_user",payload:n})}))}},addUser:function(e){return function(e,t){e.emit("USER_CONNECTED",t)}},chatUsers:function(e){return function(t){var c=Object(d.values)(t);e({type:"chat_users",payload:c})}},addMessage:function(e){return function(t,c){return function(n){var a=c.map((function(e){return e.id===t&&e.messages.push(n),e}));e({type:"send_message",payload:a})}}},sendMessage:function(e){return function(e,t,c,n){var a=c.id,s=t.name;e.emit("MESSAGE_SENT",{sender:s,chatid:a,message:n})}},setActiveChat:function(e){return function(t){e({type:"set_active_chat",payload:t})}},addPrivateChat:function(e){return function(t){e({type:"add_private_chat",payload:t})}},createGroupChat:function(e){return function(){}},createPrivateChat:function(e){return function(e,t,c,n){e.emit("PRIVATE_MESSAGE",{reciever:t,sender:c,activeChat:n})}},createCommunityChat:function(e){return function(t){t.emit("COMMUNITY_CHAT",(function(t){e({type:"community_chat",payload:t})}))}}},{user:null,users:null,chats:[],activeChat:null,msg:null}),h=b.Context,O=b.Provider,m=c(29),x=c.n(m)()("/"),f=u((function(e,t){switch(t.type){case"create_socket":return Object(o.a)(Object(o.a)({},e),{},{socket:t.payload});default:return e}}),{createSocket:function(e){return function(){x.on("connect",(function(){console.log("Connected")})),e({type:"create_socket",payload:x})}}},{socket:null}),v=f.Context,p=f.Provider,N=function(){var e=Object(a.useContext)(h),t=e.state.user,c=e.setUser,s=Object(a.useContext)(v).state.socket,r=Object(a.useState)(""),i=Object(j.a)(r,2),l=i[0],o=i[1],u=Object(a.useState)(""),d=Object(j.a)(u,2),b=d[0],O=d[1];return Object(n.jsx)("div",{className:"container",children:Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col-md-6 m-auto",children:Object(n.jsx)("div",{className:"card",children:Object(n.jsxs)("div",{className:"card-body",children:[Object(n.jsx)("h2",{className:"text-center mb-3",children:"Login"}),b?Object(n.jsx)("div",{className:"alert alert-danger",role:"alert",children:b}):null,Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),c(s,l),O(null===t?"Username taken!!!":"")},children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{children:"Username"}),Object(n.jsx)("input",{type:"text",className:"form-control",placeholder:"Please Enter Username",name:"name",onChange:function(e){o(e.target.value)}})]}),Object(n.jsx)("button",{type:"submit",className:"btn btn-primary btn-block",children:"Submit"})]})]})})})})})},C=function(e){e.sendTyping;var t,c,s=e.chat,r=Object(a.useContext)(h),i=r.state.user,l=r.sendMessage,o=Object(a.useContext)(v).state.socket,u=Object(a.useState)(""),d=Object(j.a)(u,2),b=d[0],O=d[1],m=Object(a.useState)(!1),x=Object(j.a)(m,2),f=x[0],p=x[1],N=function(){console.log("Typing"),c=setInterval((function(){Date.now()-t>300&&(p(!1),C())}),300)},C=Object(a.useCallback)((function(){console.log("Stop Typing"),c&&clearInterval(c)}),[c]);return Object(a.useEffect)((function(){return function(){C()}}),[C]),Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col-12",children:Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),l(o,i,s,b),O("")},className:"chat-box-tray",children:[Object(n.jsx)("i",{className:"material-icons",children:"sentiment_very_satisfied"}),Object(n.jsx)("input",{type:"text",placeholder:"Type Message",value:b,autoComplete:"off",onKeyPress:function(e){t=Date.now(),f||(p(!0),N())},onChange:function(e){O(e.target.value)}}),Object(n.jsx)("i",{className:"material-icons",children:"mic"}),Object(n.jsx)("button",{disabled:b.length<1,type:"submit",className:"btn p-0 ml-4",children:Object(n.jsx)("i",{className:"material-icons",children:"send"})})]})})})},g=function(e){var t=e.image;return Object(n.jsx)("div",{className:"profile-image bg-secondary d-flex",children:Object(n.jsx)("h4",{className:"text-white m-auto",children:t})})},y=function(e){var t=e.chat;return Object(n.jsx)("div",{className:"settings-tray",children:Object(n.jsxs)("div",{className:"friend-drawer friend-drawer--grey p-0",children:[Object(n.jsx)(g,{image:t.name[0].toUpperCase()}),Object(n.jsxs)("div",{className:"text",children:[Object(n.jsx)("h6",{children:t.name}),Object(n.jsx)("p",{children:"Online"})]}),Object(n.jsxs)("span",{className:"float-right",children:[Object(n.jsx)("i",{className:"material-icons",children:"attach_file"}),Object(n.jsx)("i",{className:"material-icons",children:"videocam"}),Object(n.jsx)("i",{className:"material-icons",children:"more_vert"})]})]})})},S=c(30),E=c.n(S),_=function(e){var t=e.chat,c=e.user;return Object(n.jsx)(E.a,{className:"scroll-view",children:Object(n.jsx)("div",{className:"chat-panel",children:t.messages.map((function(e){return Object(n.jsx)("div",{className:"row no-gutterse",children:Object(n.jsx)("div",{className:"d-flex flex-wrap w-100 ".concat(e.sender===c.name?"flex-row-reverse":"flex-row"),children:Object(n.jsx)("div",{className:"chat-bubble ".concat(e.sender===c.name?"chat-bubble":"chat-bubble chat-bubble--blue"),children:e.message})})},e.id)}))})})},w=c(31),k=c.n(w),U=function(){var e=Object(a.useContext)(h),t=e.state.chats,c=e.setActiveChat;return Object(n.jsx)(n.Fragment,{children:0!==t.lenght?t.map((function(e){return Object(n.jsxs)("div",{onClick:function(){return c(e)},children:[Object(n.jsxs)("div",{className:"friend-drawer friend-drawer--onhover",children:[Object(n.jsx)(g,{image:e.name[0].toUpperCase()}),Object(n.jsxs)("div",{className:"text",children:[Object(n.jsx)("h6",{children:e.name}),Object(n.jsx)("p",{children:Object(d.get)(Object(d.last)(e.messages),"message","")})]}),Object(n.jsx)("span",{className:"time small",children:Object(n.jsx)(k.a,{format:"h:mm A",children:e.time})})]}),Object(n.jsx)("hr",{})]},e.id)})):null})},T=function(){var e=Object(a.useContext)(h),t=e.state,c=t.user,s=t.users,r=t.activeChat,i=e.createPrivateChat,l=Object(a.useContext)(v).state.socket;return Object(n.jsx)(n.Fragment,{children:0!==s.lenght?Object(d.differenceBy)(s,[c],"name").map((function(e){return Object(n.jsxs)("div",{onClick:function(){return i(l,e.name,c.name,r)},children:[Object(n.jsxs)("div",{className:"friend-drawer friend-drawer--onhover",children:[Object(n.jsx)(g,{image:e.name[0].toUpperCase()}),Object(n.jsx)("div",{className:"text",children:Object(n.jsx)("h6",{children:e.name})})]}),Object(n.jsx)("hr",{})]},e.id)})):null})},M=function(e){var t=e.onSendPrivateMessage,c=Object(a.useState)(""),s=Object(j.a)(c,2),r=s[0],i=s[1];return Object(n.jsx)("div",{className:"search-box",children:Object(n.jsxs)("form",{className:"input-wrapper",onSubmit:function(e){e.preventDefault(),t(r),i("")},children:[Object(n.jsx)("i",{className:"material-icons",children:"search"}),Object(n.jsx)("input",{type:"text",value:r,placeholder:"Search",onChange:function(e){i(e.target.value)}})]})})},P=function(){return Object(n.jsx)("div",{className:"settings-tray",children:Object(n.jsx)("h2",{className:"ml-0",children:"Chats"})})};var A=function(e){var t=e.onClick,c=e.chats,a=e.users;return Object(n.jsxs)("ul",{className:"nav nav-pills nav-fill border-bottom border-top",children:[Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)("div",{onClick:function(){return t(c)},className:"nav nav-link",children:"Chats"})}),Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)("div",{onClick:function(){return t(a)},className:"nav-link",children:"Users"})})]})},R="CHATS",D=function(){var e=Object(a.useState)(R),t=Object(j.a)(e,2),c=t[0],s=t[1];return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(P,{}),Object(n.jsx)(M,{}),Object(n.jsx)(A,{onClick:s,chats:R,users:"USERS"}),Object(n.jsx)("div",{className:"overflow-auto w-100 h-100",children:c===R?Object(n.jsx)(U,{}):Object(n.jsx)(T,{})})]})},I=function(e){var t=e.user,c=Object(a.useState)(!1),s=Object(j.a)(c,2),r=s[0],i=s[1],l=Object(a.useContext)(v).state.socket,o=Object(a.useContext)(h),u=o.state,d=u.users,b=u.chats,O=u.activeChat,m=o.addMessage,x=o.addUser,f=o.chatUsers,p=o.addPrivateChat,N=o.createCommunityChat;return Object(a.useEffect)((function(){var e;return r||(x(l,t),N(l),i(!0)),b.map((function(t){return e="MESSAGE_SENT-".concat(t.id),l.once(e,m(t.id,b)),!0})),l.once("PRIVATE_MESSAGE",(function(e){p(e)})),l.once("USER_CONNECTED",(function(e){f(e)})),function(){l.off(e),l.off("USER_CONNECTED"),l.off("PRIVATE_MESSAGE")}}),[t,d,b,r,f,x,m,N,p,l]),Object(n.jsx)("div",{className:"container",children:Object(n.jsx)("div",{className:"card",children:Object(n.jsxs)("div",{className:"row no-gutters",children:[Object(n.jsx)("div",{className:"col-md-4 border-right col-xs-12 sidebar",children:Object(n.jsx)(D,{})}),Object(n.jsx)("div",{className:"col-md-8 col-xs-12 panel ".concat(O?null:"d-flex justify-content-center align-items-center"),children:null!==O?Object(n.jsxs)("div",{children:[Object(n.jsx)(y,{chat:O}),Object(n.jsx)(_,{chat:O,user:t}),Object(n.jsx)(C,{chat:O})]}):Object(n.jsx)("div",{children:Object(n.jsx)("h3",{children:"Choose a chat!!!"})})})]})})})},G=function(){var e=Object(a.useContext)(h).state.user,t=Object(a.useContext)(v),c=t.state.socket,s=t.createSocket;return Object(a.useEffect)((function(){return null===c&&s(),function(){if(null!==c)return c.disconnect(),!0}}),[s,c]),Object(n.jsx)("div",{children:null===e?Object(n.jsx)(N,{}):Object(n.jsx)(I,{user:e})})};c(66);i.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(O,{children:Object(n.jsx)(p,{children:Object(n.jsx)(G,{})})})}),document.getElementById("root"))}},[[67,1,2]]]);
//# sourceMappingURL=main.0d47db31.chunk.js.map